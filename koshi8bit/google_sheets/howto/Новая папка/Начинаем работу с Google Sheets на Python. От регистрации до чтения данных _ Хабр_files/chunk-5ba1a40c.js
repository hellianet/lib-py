(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ba1a40c"],{"597a":function(t,e,n){"use strict";n("ca05")},"5be8":function(t,e,n){},"6f56":function(t,e,n){},"926d":function(t,e,n){"use strict";n("6f56")},a8df:function(t,e,n){},ba56:function(t,e,n){"use strict";n("5be8")},ca05:function(t,e,n){},ef70:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tm-article-comments",class:{"tm-article-comments_without-removed":t.isRemovedCommentsHidden}},[n("TMComments",{attrs:{"comment-component":t.$options.components.TMArticleComment,comments:t.comments,"comments-count":t.commentsCount,"complaint-action":t.canSendComplaint?t.complaintAction:null,"favorite-action":t.toggleFavorite,"get-comment-link":t.getCommentLink,"in-storage":t.getCommentsByArticleInStorage,"is-loading":t.isLoading,"is-processing-form":t.isCommentFormDisabled,notice:t.noticeData,"root-commenting-enabled":t.hasRootLevelForm,"vote-action":t.vote},on:{addToStorage:t.onAddToStorage,commentDelete:t.onCommentDelete,commentPreview:t.onCommentPreview,commentSubmit:t.onCommentSend,deleteFromStorage:t.onDeleteFromStorage},scopedSlots:t._u([{key:"headerAside",fn:function(){return[n("TMRssButton",{attrs:{variant:"comments-header"}}),!t.isLoading&&t.isLoggedIn?n("TMArticleSubscriptionControls",{staticClass:"tm-article-comments__subscription",attrs:{"article-id":t.articleId}}):t._e()]},proxy:!0},{key:"body",fn:function(){return[t.isSuperAdmin?n("div",{staticClass:"tm-article-comments__controls"},[n("TMButtonBase",{staticClass:"tm-article-comments__moderate-button",attrs:{"style-size":"medium","style-type":"transparent"},on:{click:t.resetCache}},[t._v("\n          "+t._s(t.msg("ARTICLE_CLEAR_CACHE_COMMENTS"))+"\n        ")]),n("TMButtonBase",{staticClass:"tm-article-comments__moderate-button",attrs:{"style-size":"medium","style-type":"transparent"},on:{click:t.toggleCommentsState}},[t._v("\n          "+t._s(t.commentsStateActionText)+"\n        ")]),n("TMButtonBase",{staticClass:"tm-article-comments__moderate-button",attrs:{"style-size":"medium","style-type":"transparent"},on:{click:t.toggleRemovedComments}},[t._v("\n          "+t._s(t.removedCommentsActionText)+"\n        ")])],1):t._e()]},proxy:!0},{key:"afterComments",fn:function(){return[t.isLoggedIn?n("TMCommentsNavigation",{attrs:{"fresh-comments":t.freshComments,loading:t.isLoadingNewComments},on:{readComment:t.onReadComment,refresh:t.onUpdateComment}}):t._e()]},proxy:!0}])})],1)},r=[],i=n("2f62"),s=n("884d"),a=n("6862"),c=n("64e7"),m=n("f3a9"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tm-article-subscription-controls"},[n("button",{staticClass:"tm-article-subscription-controls__button",class:{"tm-article-subscription-controls__button_active":t.isSubscribed},attrs:{title:t.msg("ARTICLE_SUBSCRIBE_TITLE")},on:{click:t.openModal}},[n("TMSvgImg",{attrs:{id:t.icon,size:"24",title:t.msg("ARTICLE_SUBSCRIBE_TITLE")}})],1),t.modalVisible?n("TMPopup",{attrs:{title:t.msg("ARTICLE_SUBSCRIBE_TITLE")},on:{close:function(e){t.modalVisible=!1}}},[n("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[n("div",{staticClass:"tm-article-subscription-controls__checkbox"},[n("TMLabeledCheckbox",{attrs:{name:"subscription_tracker"},model:{value:t.form.tracker,callback:function(e){t.$set(t.form,"tracker",e)},expression:"form.tracker"}},[t._v("\n          "+t._s(t.msg("ARTICLE_SUBSCRIBE_TRACKER"))+"\n        ")])],1),n("div",{staticClass:"tm-article-subscription-controls__checkbox"},[n("TMLabeledCheckbox",{attrs:{name:"subscription_email"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}},[t._v("\n          "+t._s(t.msg("ARTICLE_SUBSCRIBE_EMAIL"))+"\n        ")])],1),n("div",{staticClass:"tm-article-subscription-controls__submit"},[n("TMButtonBase",{attrs:{"style-size":"large","style-type":"solid"},on:{click:t.onSubmit}},[t._v("\n          "+t._s(t.msg("ARTICLE_SUBSCRIBE_SAVE"))+"\n        ")])],1)])]):t._e()],1)},u=[],f=n("90e1"),d=n("badd"),h=n("b7d0");function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){C(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g={name:"TMArticleSubscriptionControls",components:{TMPopup:d["a"],TMSvgImg:h["a"],TMLabeledCheckbox:f["a"],TMButtonBase:s["a"]},props:{articleId:{type:[String,Number],required:!0}},data:function(){return{modalVisible:!1,form:null}},computed:{isSubscribedToTracker:function(){return this.$store.getters["articlesList/isSubscribedToTracker"](this.articleId)},isSubscribedToEmail:function(){return this.$store.getters["articlesList/isSubscribedToEmail"](this.articleId)},isSubscribed:function(){return this.isSubscribedToTracker||this.isSubscribedToEmail},icon:function(){return this.isSubscribed?"notifications-filled":"notifications"}},methods:b(b({},Object(i["b"])("articlesList",["toggleSubscriptionStatus"])),{},{openModal:function(){this.form={tracker:this.isSubscribedToTracker,email:this.isSubscribedToEmail},this.modalVisible=!0},onSubmit:function(){var t=this;this.toggleSubscriptionStatus(b({articleId:this.articleId},this.form)).catch((function(e){t.$toast.error(e.message)})),this.modalVisible=!1}})},v=g,y=(n("597a"),n("2877")),_=Object(y["a"])(v,l,u,!1,null,null,null),S=_.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tm-comment-navigation tm-comment-navigation__block",class:t.showCounter},[n("button",{directives:[{name:"show",rawName:"v-show",value:!t.hasUnreadComments,expression:"!hasUnreadComments"},{name:"hotkey",rawName:"v-hotkey.stop",value:{r:t.updateComments},expression:"{ 'r': updateComments }",modifiers:{stop:!0}}],staticClass:"tm-comment-navigation__button tm-comment-navigation__button_refresh",attrs:{title:t.msg("UPDATE_COMMENTS")},on:{click:t.updateComments}},[n("TMRefreshserCommentsIcon",{staticClass:"tm-comment-navigation__icon tm-comment-navigation__icon_refresh",class:{"tm-comment-navigation__icon_loading":t.loading}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.hasUnreadComments,expression:"hasUnreadComments"}],staticClass:"tm-comment-navigation__wrapper"},[n("button",{directives:[{name:"hotkey",rawName:"v-hotkey.stop",value:{k:t.goToPrevClosestCommentThrottled},expression:"{ 'k': goToPrevClosestCommentThrottled }",modifiers:{stop:!0}}],staticClass:"tm-comment-navigation__button",attrs:{title:t.msg("GO_TO_PREV_COMMENT"),type:"button"},on:{click:t.goToPrevClosestCommentThrottled}},[n("TMRefreshserCommentsUpIcon",{staticClass:"tm-comment-navigation__icon tm-comment-navigation__icon__up"})],1),n("button",{directives:[{name:"hotkey",rawName:"v-hotkey.stop",value:{f:t.readFirstUnreadCommentThrottled},expression:"{ 'f': readFirstUnreadCommentThrottled }",modifiers:{stop:!0}}],staticClass:"tm-comment-navigation__counter",attrs:{title:t.msg("GO_TO_FIRST_UNREAD_COMMENT"),type:"button"},on:{click:t.readFirstUnreadCommentThrottled}},[t._v("\n      "+t._s(t.freshComments.length)+"\n    ")]),n("button",{directives:[{name:"hotkey",rawName:"v-hotkey.stop",value:{j:t.goToNextClosestCommentThrottled},expression:"{ 'j': goToNextClosestCommentThrottled }",modifiers:{stop:!0}}],staticClass:"tm-comment-navigation__button",attrs:{title:t.msg("GO_TO_NEXT_COMMENT"),type:"button"},on:{click:t.goToNextClosestCommentThrottled}},[n("TMRefreshserCommentsUpIcon",{staticClass:"tm-comment-navigation__icon tm-comment-navigation__icon_down"})],1)])])},T=[],A=n("84a2"),I=n.n(A),E=n("09f4");function w(t){return w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function M(t,e){return N(t)||L(t,e)||R(t,e)||j()}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(t,e){if(t){if("string"===typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function L(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done);s=!0)if(i.push(o.value),e&&i.length===e)break}catch(c){a=!0,r=c}finally{try{s||null==n["return"]||n["return"]()}finally{if(a)throw r}}return i}}function N(t){if(Array.isArray(t))return t}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}function P(t){var e=V();return function(){var n,o=q(t);if(e){var r=q(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return D(this,n)}}function D(t,e){return!e||"object"!==w(e)&&"function"!==typeof e?U(t):e}function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F(t){var e="function"===typeof Map?new Map:void 0;return F=function(t){if(null===t||!H(t))return t;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return $(t,arguments,q(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),J(n,t)},F(t)}function $(t,e,n){return $=V()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var r=Function.bind.apply(t,o),i=new r;return n&&J(i,n.prototype),i},$.apply(null,arguments)}function V(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function H(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function J(t,e){return J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},J(t,e)}function q(t){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},q(t)}var z=function(t){x(n,t);var e=P(n);function n(){return B(this,n),e.call(this,"Element is not focusable")}return n}(F(Error)),G=function(t){x(n,t);var e=P(n);function n(){return B(this,n),e.call(this,"Scroll to the element has been prevented")}return n}(F(Error)),K=function(t){return new Promise((function(e,n){var o,r=function t(){n(new G),o&&o.disconnect(),window.removeEventListener("wheel",t)};o=new IntersectionObserver((function(t){var n=M(t,1),i=n[0];i.isIntersecting&&(e(),o.disconnect(),window.removeEventListener("wheel",r))})),o.observe(t),window.addEventListener("wheel",r)}))},X=function(t){return new Promise((function(e,n){if(null!==t.offsetParent){var o=t.getBoundingClientRect(),r=o.top,i=Object(E["a"])();0!==r?(window.scrollTo({top:t.getBoundingClientRect().top+window.scrollY-i,behavior:"smooth"}),e(K(t))):e(!0)}else n(new z)}))},Y=n("1f65");function W(t,e){return nt(t)||et(t,e)||Z(t,e)||Q()}function Q(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Z(t,e){if(t){if("string"===typeof t)return tt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(t,e):void 0}}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function et(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done);s=!0)if(i.push(o.value),e&&i.length===e)break}catch(c){a=!0,r=c}finally{try{s||null==n["return"]||n["return"]()}finally{if(a)throw r}}return i}}function nt(t){if(Array.isArray(t))return t}var ot=function(){return n.e("chunk-2d0af40b").then(n.t.bind(null,"0e11",7))},rt=function(){return n.e("chunk-2d0e5f94").then(n.t.bind(null,"9788",7))},it="xpanel_mobile",st=function(t){var e=t.getAttribute("name").split("comment_"),n=W(e,2),o=n[1];return o},at=function(t){return t.offsetParent},ct=function(){var t=Array.from(document.querySelectorAll("[data-comment-new]"));if(0===t.length)return[];var e=t.filter(at);return 0===e.length?t:e},mt=function(){var t=ct();return 0===t.length?null:t[0]},lt=function(){return Array.from(document.querySelectorAll("[data-selected-comment]")).forEach((function(t){delete t.dataset.selectedComment}))},ut=function(t){t.dataset.selectedComment="true"},ft=function(t){lt(),ut(t)},dt=function(){return document.querySelector("[data-selected-comment]")},ht=function(){var t=document.documentElement.getBoundingClientRect(),e=t.top;return window.scrollY===Math.abs(e)},pt=function(){var t,e=ct();if(0===e.length)return null;if(ht())t=e.indexOf(dt())-1;else{var n=Object(Y["a"])(e);if(!n)return null;t=e.indexOf(n)-1}return e[t]||e[e.length-1]},bt=function(){var t,e=ct();if(0===e.length)return null;if(ht())t=e.indexOf(dt())+1;else{var n=Object(Y["a"])(e);if(!n)return null;var o=0===n.getBoundingClientRect().top,r=e.indexOf(n);t=o?r+1:r}return e[t]||e[0]},Ct=function t(e){return e?at(e)?e:t(e.parentElement):null},gt=function(t){return function(e){if(e instanceof z){var n=Ct(t).querySelector("[data-comment-collapsed-thread]");X(n,"start")}}},vt=function(t){if(t.parentElement){var e=t.parentElement.querySelector("[data-comment-header]");e&&e.focus()}},yt=function(){var t=bt();t&&X(t).then((function(){ft(t),Object(a["c"])(it,"next"),vt(t)})).catch(gt(t))},_t=function(){var t=pt();t&&X(t).then((function(){ft(t),Object(a["c"])(it,"prev"),vt(t)})).catch(gt(t))},St={name:"TMCommentsNavigation",components:{TMRefreshserCommentsIcon:rt,TMRefreshserCommentsUpIcon:ot},props:{loading:{type:Boolean,default:!1},freshComments:{type:Array,default:null}},computed:{hasUnreadComments:function(){return 0!==this.freshComments.length},showCounter:function(){return this.hasUnreadComments?"tm-comment-navigation__has-new":"tm-comment-navigation__has-new_reverse"},goToNextClosestCommentThrottled:function(){return I()(yt,500)},goToPrevClosestCommentThrottled:function(){return I()(_t,500)},readFirstUnreadCommentThrottled:function(){return I()(this.readFirstUnreadComment,500)}},methods:{updateComments:function(t){t.target.blur(),this.$emit("refresh"),Object(a["c"])(it,"update")},readFirstUnreadComment:function(){var t=this,e=mt();if(e){var n=st(e);X(e).then((function(o){Object(a["c"])(it,"middle"),o?t.$emit("readComment",n):setTimeout((function(){t.$emit("readComment",n)}),250),vt(e)})).catch((function(e){e instanceof z&&(Object(a["c"])(it,"middle"),t.$emit("readComment",n))}))}}}},Ot=St,Tt=(n("ba56"),Object(y["a"])(Ot,O,T,!1,null,null,null)),At=Tt.exports,It=n("084a"),Et=n("47e8"),wt=n("0a5f");function Mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(n),!0).forEach((function(e){Rt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kt(t){return xt(t)||Bt(t)||Nt(t)||Lt()}function Lt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Nt(t,e){if(t){if("string"===typeof t)return Pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pt(t,e):void 0}}function Bt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function xt(t){if(Array.isArray(t))return Pt(t)}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Dt(t){return kt(new Set(t))}var Ut={name:"TMArticleComments",components:{TMArticleComment:m["a"],TMComments:It["a"],TMRssButton:Et["a"],TMCommentsNavigation:At,TMArticleSubscriptionControls:S,TMButtonBase:s["a"]},props:{articleId:{type:[Number,String],required:!0},isLoading:{type:Boolean,default:!1}},data:function(){return{isRemovedCommentsHidden:!1,isCommentFormDisabled:!1,isLoadingNewComments:null,commentFormValue:null}},computed:jt(jt(jt(jt(jt({},Object(i["e"])({freshComments:function(t){return t.comments.pageArticleComments.freshComments}})),Object(i["c"])("comments",["getCommentById","getCommentAccess","hasRootLevelForm","getPreviewComment","threads"])),Object(i["c"])("articlesList",["getArticleById"])),Object(i["c"])("me",["isLoggedIn","userAlias","isSuperAdmin","canSendComplaint"])),{},{article:function(){return this.getArticleById(this.articleId)},comments:function(){var t=this.getCommentById;return this.threads.map((function e(n){var o=t(n);return jt(jt({},o),{},{children:Array.from(o.children).map(e)})}))},getArticlesInStorage:function(){return JSON.parse(Object(c["a"])("articlesStack"))||[]},getCommentsInStorage:function(){return JSON.parse(Object(c["a"])("collapsedComments"))||{}},getCommentsByArticleInStorage:function(){if(-1!==this.getArticlesInStorage.indexOf(this.articleId)){var t=JSON.parse(Object(c["a"])("collapsedComments"))||{};return t["".concat(this.articleId)]||[]}return[]},isCanComment:function(){return this.getCommentAccess&&this.getCommentAccess.isCanComment},commentAccessMessage:function(){return this.getCommentAccess&&this.getCommentAccess.cantCommentReasonKey?this.msg("EXTERNAL_".concat(this.getCommentAccess.cantCommentReasonKey)):""},loginUrl:function(){var t="/kek/v1/auth/habrahabr/";return"".concat(t,"?back=").concat(this.$route.path,"&hl=").concat(this.langOptions.hl)},noticeData:function(){return this.isLoggedIn&&!this.isCanComment?{type:"negative",message:this.commentAccessMessage}:this.isLoggedIn?null:{type:"positive",message:this.msg("COMMENT_NOTICE_UNAUTH_DECLARATION",{url:this.loginUrl})}},removedCommentsActionText:function(){return this.isRemovedCommentsHidden?this.msg("ARTICLE_SHOW_REMOVED_COMMENTS"):this.msg("ARTICLE_HIDE_REMOVED_COMMENTS")},commentsStateActionText:function(){return this.article.commentsEnabled?this.msg("ARTICLE_DISABLE_COMMENTS"):this.msg("ARTICLE_ENABLE_COMMENTS")},commentsCount:function(){return this.article&&this.article.statistics?this.article.statistics.commentsCount:null}}),mounted:function(){Object(c["b"])("collapsed_comments")},methods:jt(jt(jt(jt({},Object(i["b"])("articlesList",["setArticleCommentsStatus"])),Object(i["b"])("comments",["closeForm","getComments","loadNewComments","previewComment","sendComment","suspendComment","toggleFavorite","vote"])),Object(i["d"])("comments",["setCommentRead","removeFromFreshComments"])),{},{toggleRemovedComments:function(){this.isRemovedCommentsHidden=!this.isRemovedCommentsHidden},onCommentPreview:function(t){var e=this,n={articleId:this.articleId,parentId:t.parentId,text:t.value};return this.previewComment(n).catch((function(t){e.isCommentFormDisabled=!1,e.$toast.error(t.message)}))},onCommentDelete:function(t){var e={articleId:this.articleId,commentId:t.parentId};this.suspendComment(e)},complaintAction:function(t){var e=this;return Object(wt["o"])(this.articleId,t.parentId,{message:t.value}).then((function(){e.$toast.success(e.msg("COMMENT_COMPLAINT_SUCCESS"))})).catch((function(t){e.$toast.error(t.message)}))},onCommentSend:function(t){var e=this,n={articleId:this.articleId,parentId:t.parentId,text:t.value};return this.isCommentFormDisabled=!0,this.sendComment(n).then((function(n){e.isCommentFormDisabled=!1,e.commentFormValue="",t.value.done&&t.value.done(),n&&Object(a["c"])("comment",e.GAAction,e.userAlias)})).catch((function(t){e.isCommentFormDisabled=!1,e.handleCommentsError(t)}))},onUpdateComment:function(){var t=this;this.isLoadingNewComments=!0;var e=this.$route;this.loadNewComments({route:e}).then((function(){t.isLoadingNewComments=!1})).catch((function(e){t.isLoadingNewComments=!1,t.handleCommentsError(e)}))},handleCommentsError:function(t){var e=t.data&&t.data.text&&t.data.text.source&&Array.isArray(t.data.text.source);e?this.$toast.error(t.data.text.source[0]):this.$toast.error(t.message)},onReadComment:function(t){this.setCommentRead({commentId:t}),this.removeFromFreshComments(t)},onDeleteFromStorage:function(t){var e=this.getCommentsByArticleInStorage,n=this.getArticlesInStorage,o=e.indexOf(t);if(-1!==o&&e.splice(o,1),0===e.length){var r=n.indexOf(this.articleId);-1!==r&&n.splice(r,1),delete this.getCommentsInStorage[this.articleId]}else Object.assign(this.getCommentsInStorage,Rt({},this.articleId,e));var i=Dt(n);Object(c["c"])("collapsedComments",JSON.stringify(this.getCommentsInStorage)),Object(c["c"])("articlesStack",JSON.stringify(i))},onAddToStorage:function(t){var e=this.getArticlesInStorage;e.length>500&&e.shift(),e.push(this.articleId),e=Dt(e),Object(c["c"])("articlesStack",JSON.stringify(e));var n=this.getCommentsByArticleInStorage,o=this.getCommentsInStorage;n.push(t),Object.assign(o,Rt({},this.articleId,n)),Object(c["c"])("collapsedComments",JSON.stringify(o))},disableArticleComments:function(t){var e=window.confirm(this.msg("ARTICLE_DISABLE_COMMENTS_CONFIRM"));if(!e)return!1;var n=prompt(this.msg("ARTICLE_DISABLE_COMMENTS_REASON"));return Object(wt["c"])(t,{reason:n})},toggleCommentsState:function(){var t=this,e=this.article.commentsEnabled?this.disableArticleComments:wt["f"];return e(this.articleId).then((function(){return t.setArticleCommentsStatus({articleId:t.articleId,status:!t.article.commentsEnabled}),t.getComments({route:t.$route})})).catch((function(e){return t.$toast.error(e.message)}))},resetCache:function(){var t=this;return Object(wt["n"])(this.articleId).then((function(){t.$toast.success(t.msg("ARTICLE_CLEAR_CACHE_SUCCESS_MESSAGE")),setTimeout((function(){window.location.reload()}),1e3)})).catch((function(e){return t.$toast.error(e.message)}))},getCommentLink:function(t){return"".concat(window.location.origin).concat(this.$route.path,"#comment_").concat(t.id)}})},Ft=Ut,$t=(n("fad9"),Object(y["a"])(Ft,o,r,!1,null,null,null));e["default"]=$t.exports},f3a9:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("TMComment",{attrs:{comment:t.comment,"is-comment-controls-shown":t.isCommentControlsShown,"popup-toggle-visible":t.popupToggleVisible,"should-display-status":t.shouldDisplayStatus,"user-popover-enabled":t.userPopoverEnabled},scopedSlots:t._u([{key:"comment-link",fn:function(e){var o=e.datetimeStr;return[t._t("comment-link",(function(){return[n("TMArticleCommentsLink",{staticClass:"tm-article-comment__link",attrs:{article:t.comment.post,"comment-id":t.comment.id}},[t._v("\n        "+t._s(t.msg("DATE_FORMAT",o))+"\n      ")])]}),{datetimeStr:o})]}}],null,!0)})},r=[],i=n("0414"),s=n("79f0"),a={name:"TMArticleComment",components:{TMArticleCommentsLink:i["a"],TMComment:s["a"]},props:{comment:{type:Object,required:!0},isCommentControlsShown:{type:Boolean,default:!0},shouldDisplayStatus:{type:Boolean,default:!0},userPopoverEnabled:Boolean,popupToggleVisible:Boolean}},c=a,m=(n("926d"),n("2877")),l=Object(m["a"])(c,o,r,!1,null,null,null);e["a"]=l.exports},fad9:function(t,e,n){"use strict";n("a8df")}}]);
//# sourceMappingURL=chunk-5ba1a40c.2b9a7d0b.js.map